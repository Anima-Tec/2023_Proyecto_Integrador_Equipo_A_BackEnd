// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = "mysql://root:@localhost:3306/masfocodb?schema=public"
}

model Localidad {
  id          Int       @id @default(autoincrement())
  name        String
  Institucion Oficina[] @relation("LocalidadInstitucion")
}

model Institucion {
  id       Int       @id @default(autoincrement())
  name     String
  dominio  String
  oficinas Oficina[] @relation("LocalidadInstitucion")
}

model Oficina {
  id            Int         @id @default(autoincrement())
  name          String
  direccion     String
  piso          Int?
  idLocalidad   Int         @map("idLocalidad")
  idInstitucion Int         @map("idInstitucion")
  Localidad     Localidad   @relation("LocalidadInstitucion", fields: [idLocalidad], references: [id])
  Institucion   Institucion @relation("LocalidadInstitucion", fields: [idInstitucion], references: [id])
  users         User[]
}

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  Oficina   Oficina? @relation(fields: [oficinaId], references: [id])
  oficinaId Int?
  Report    Report[]
}

enum Role {
  Supervisor
  Tecnico
  User
}

model Report {
  id           Int       @id @default(autoincrement())
  title        String
  description  String
  category     String
  creationDate DateTime
  endDate      DateTime?
  idUser       Int       @map("idUser")
  user         User      @relation(fields: [idUser], references: [id])
  status       Status
  urgency      Urgency
}

enum Status {
  Abierto
  EnProgreso
  EnRevision
  Cerrado
}

enum Urgency {
  Low
  Medium
  High
  Critical
}
